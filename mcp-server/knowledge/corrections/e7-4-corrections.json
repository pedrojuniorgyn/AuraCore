{
  "epic": "E7.4",
  "corrections": [
    {
      "id": "LC-424614",
      "date": "2025-12-29",
      "epic": "E7.4",
      "error": "E7.4 Semana 1: Domain Layer Fiscal - FiscalDocument, CFOP, FiscalKey, legislação BR",
      "correction": "FiscalDocument (Aggregate Root) com ciclo de vida DRAFT→PENDING→PROCESSING→AUTHORIZED. FiscalDocumentItem (Entity) com NCM/CFOP. CFOP (Value Object) com validação 4 dígitos e classificação entrada/saída/interestadual. FiscalKey (Value Object) com 44 dígitos e dígito verificador Módulo 11. 10 Domain Errors específicos para fiscal. 5 Domain Events. IFiscalDocumentRepository port.",
      "files_affected": [
        "src/modules/fiscal/domain/entities/FiscalDocument.ts",
        "src/modules/fiscal/domain/entities/FiscalDocumentItem.ts",
        "src/modules/fiscal/domain/value-objects/CFOP.ts",
        "src/modules/fiscal/domain/value-objects/FiscalKey.ts",
        "src/modules/fiscal/domain/value-objects/DocumentType.ts",
        "src/modules/fiscal/domain/errors/FiscalErrors.ts",
        "src/modules/fiscal/domain/events/FiscalEvents.ts",
        "src/modules/fiscal/domain/ports/output/IFiscalDocumentRepository.ts"
      ],
      "pattern_created": null,
      "status": "APPROVED",
      "must_not_repeat": true
    },
    {
      "id": "LC-139381",
      "date": "2025-12-29",
      "epic": "E7.4",
      "error": "E7.4 Semana 2: Domain Layer Tax - Motor de cálculo tributário brasileiro (ICMS/ISS/IPI/PIS/COFINS)",
      "correction": "Value Objects: CST (3 dígitos), CSOSN (Simples Nacional), Aliquota (0-300%), BaseCalculo (com redução), TaxAmount (validação). Calculators: ICMSCalculator (normal + ST + redução + Simples), IPICalculator, PISCalculator (cumulativo 0.65% / não cumulativo 1.65%), COFINSCalculator (cumulativo 3% / não cumulativo 7.6%), ISSCalculator (2-5%). CurrentTaxEngine: implementa ITaxEngine com todos os calculators. 10 Domain Errors. 83 testes unitários (100% passando).",
      "files_affected": [
        "src/modules/fiscal/domain/tax/value-objects/CST.ts",
        "src/modules/fiscal/domain/tax/value-objects/CSOSN.ts",
        "src/modules/fiscal/domain/tax/value-objects/Aliquota.ts",
        "src/modules/fiscal/domain/tax/value-objects/BaseCalculo.ts",
        "src/modules/fiscal/domain/tax/value-objects/TaxAmount.ts",
        "src/modules/fiscal/domain/tax/calculators/ICMSCalculator.ts",
        "src/modules/fiscal/domain/tax/calculators/IPICalculator.ts",
        "src/modules/fiscal/domain/tax/calculators/PISCalculator.ts",
        "src/modules/fiscal/domain/tax/calculators/COFINSCalculator.ts",
        "src/modules/fiscal/domain/tax/calculators/ISSCalculator.ts",
        "src/modules/fiscal/domain/tax/engines/ITaxEngine.ts",
        "src/modules/fiscal/domain/tax/engines/CurrentTaxEngine.ts",
        "src/modules/fiscal/domain/tax/errors/TaxErrors.ts"
      ],
      "pattern_created": null,
      "status": "APPROVED",
      "must_not_repeat": true
    }
  ]
}