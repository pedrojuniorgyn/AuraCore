# E7.17 - PLANO DE MIGRA√á√ÉO SPED PARA DDD

**Data:** 13/01/2026  
**Tipo:** PLANO DE MIGRA√á√ÉO  
**√âpico:** E7.17  
**Status:** üìù AGUARDANDO APROVA√á√ÉO

---

## üéØ OBJETIVO ESTRAT√âGICO

Completar a migra√ß√£o DDD dos geradores SPED iniciada no E7.13, garantindo:
1. **Zero regress√µes** - Arquivos SPED id√™nticos aos legados
2. **Arquitetura limpa** - 100% DDD/Hexagonal
3. **Testabilidade** - Coverage 100% em Domain
4. **Seguran√ßa fiscal** - Valida√ß√£o SEFAZ aprovada

---

## üìä SITUA√á√ÉO ATUAL

### ‚úÖ O QUE J√Å EXISTE (E7.13)

```
src/modules/fiscal/
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SpedFiscalGenerator.ts       ‚úÖ Criado (596 linhas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SpedEcdGenerator.ts          ‚úÖ Criado
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SpedContributionsGenerator.ts ‚úÖ Criado
‚îÇ   ‚îú‚îÄ‚îÄ value-objects/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SpedBlock.ts                 ‚úÖ Criado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SpedDocument.ts              ‚úÖ Criado
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SpedRegister.ts              ‚úÖ Criado
‚îÇ   ‚îú‚îÄ‚îÄ ports/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ISpedDataRepository.ts       ‚úÖ Criado (interface completa)
‚îÇ   ‚îî‚îÄ‚îÄ errors/
‚îÇ       ‚îî‚îÄ‚îÄ SpedError.ts                 ‚úÖ Criado
‚îú‚îÄ‚îÄ application/
‚îÇ   ‚îî‚îÄ‚îÄ use-cases/
‚îÇ       ‚îú‚îÄ‚îÄ GenerateSpedFiscalUseCase.ts     ‚úÖ Criado
‚îÇ       ‚îú‚îÄ‚îÄ GenerateSpedEcdUseCase.ts        ‚úÖ Criado
‚îÇ       ‚îî‚îÄ‚îÄ GenerateSpedContributionsUseCase.ts ‚úÖ Criado
‚îî‚îÄ‚îÄ infrastructure/
    ‚îî‚îÄ‚îÄ persistence/
        ‚îî‚îÄ‚îÄ DrizzleSpedDataRepository.ts  ‚úÖ Criado (557 linhas)
```

### ‚ùå O QUE FALTA

1. **Compara√ß√£o de L√≥gica:** Verificar se toda l√≥gica legada foi migrada
2. **Testes:** Criar suite completa de testes
3. **APIs:** Migrar rotas para usar Use Cases DDD
4. **Valida√ß√£o:** Comparar arquivos gerados (legado vs. DDD)
5. **Remo√ß√£o:** Deletar c√≥digo legado ap√≥s valida√ß√£o
6. **DI:** Registrar servi√ßos no container de inje√ß√£o

---

## üöÄ ESTRAT√âGIA DE MIGRA√á√ÉO

### Abordagem: COMPLETAR + VALIDAR + REMOVER

```mermaid
graph LR
    A[C√≥digo Legado] --> B[C√≥digo DDD Parcial]
    B --> C[Comparar L√≥gica]
    C --> D[Completar Gaps]
    D --> E[Criar Testes]
    E --> F[Migrar APIs]
    F --> G[Validar SEFAZ]
    G --> H[Deploy]
    H --> I[Remover Legado]
```

### Fases

| Fase | Nome | Dura√ß√£o | Deliverables |
|------|------|---------|--------------|
| 1 | Compara√ß√£o de C√≥digo | 4h | Gap analysis por arquivo |
| 2 | Completar Gaps | 8h | Domain Services completos |
| 3 | Testes Unit√°rios | 6h | Coverage 100% Domain |
| 4 | Testes Integra√ß√£o | 4h | Coverage 90% Infra |
| 5 | Migra√ß√£o de APIs | 4h | Rotas usando Use Cases |
| 6 | Valida√ß√£o SEFAZ | 4h | Arquivos validados |
| 7 | Deploy Staging | 2h | Homologa√ß√£o |
| 8 | Deploy Produ√ß√£o | 2h | Feature toggle |
| 9 | Remo√ß√£o Legado | 2h | C√≥digo legado deletado |
| **TOTAL** | - | **36h** | **~5 dias √∫teis** |

---

## üìã PLANO DETALHADO POR ARQUIVO

### 1Ô∏è‚É£ SPED CONTRIBUI√á√ïES (PRIORIDADE 1)

**Arquivo Legado:** `src/services/sped-contributions-generator.ts` (267 linhas)  
**Arquivo DDD:** `src/modules/fiscal/domain/services/SpedContributionsGenerator.ts`  
**Dura√ß√£o Estimada:** 4-6h

#### Tarefas

##### 1.1 Gap Analysis (1h)
```bash
# Comparar l√≥gica bloco a bloco
diff -u <(cat src/services/sped-contributions-generator.ts | grep "function") \
        <(cat src/modules/fiscal/domain/services/SpedContributionsGenerator.ts | grep "async")

# Verificar queries SQL
grep -A20 "db.execute" src/services/sped-contributions-generator.ts > legado_queries.txt
grep -A20 "repository\." src/modules/fiscal/domain/services/SpedContributionsGenerator.ts > ddd_queries.txt
```

**Checklist:**
- [ ] Bloco 0: Cadastros - ‚úÖ Migrado / ‚ùå Faltando
- [ ] Bloco A: Receitas (CTe) - ‚úÖ Migrado / ‚ùå Faltando
- [ ] Bloco C: Cr√©ditos (NFe) - ‚úÖ Migrado / ‚ùå Faltando
- [ ] Bloco M: Apura√ß√£o PIS/COFINS - ‚úÖ Migrado / ‚ùå Faltando
- [ ] Bloco 9: Encerramento - ‚úÖ Migrado / ‚ùå Faltando

##### 1.2 Completar Gaps (2h)
- Adicionar l√≥gica faltante em `SpedContributionsGenerator.ts`
- Adicionar queries faltantes em `DrizzleSpedDataRepository.ts`
- Validar Result Pattern em todos os m√©todos

##### 1.3 Testes Unit√°rios (2h)
```typescript
// tests/unit/modules/fiscal/domain/SpedContributionsGenerator.test.ts
describe('SpedContributionsGenerator', () => {
  let generator: SpedContributionsGenerator;
  let mockRepository: jest.Mocked<ISpedDataRepository>;

  beforeEach(() => {
    mockRepository = {
      getOrganization: jest.fn(),
      getCteContributions: jest.fn(),
      getNFeContributions: jest.fn(),
      getTaxTotalsContributions: jest.fn(),
    };
    generator = new SpedContributionsGenerator(mockRepository);
  });

  it('deve gerar SPED Contribui√ß√µes v√°lido', async () => {
    // Arrange
    mockRepository.getOrganization.mockResolvedValue(Result.ok({...}));
    
    // Act
    const result = await generator.generate({...});
    
    // Assert
    expect(result.isSuccess).toBe(true);
    expect(result.value.blockCount).toBe(5);
  });
});
```

**Coverage Target:** 100%

##### 1.4 Testes Integra√ß√£o (1h)
```typescript
// tests/integration/modules/fiscal/DrizzleSpedDataRepository.test.ts
describe('DrizzleSpedDataRepository - Contribui√ß√µes', () => {
  let repository: DrizzleSpedDataRepository;

  beforeAll(async () => {
    await seedTestDatabase(); // Criar dados de teste
  });

  it('deve buscar CTes para contribui√ß√µes', async () => {
    const result = await repository.getCteContributions({
      organizationId: 1n,
      referenceMonth: 1,
      referenceYear: 2026,
    });
    
    expect(result.isSuccess).toBe(true);
    expect(result.value).toHaveLength(5); // 5 CTes no seed
  });
});
```

**Coverage Target:** 90%

##### 1.5 Migra√ß√£o API (30min)
```typescript
// src/app/api/sped/contributions/generate/route.ts

import { GenerateSpedContributionsUseCase } from '@/modules/fiscal/application/use-cases';

export async function POST(req: Request) {
  const { organizationId, month, year } = await req.json();
  
  // ‚ùå ANTES (legado):
  // const file = await generateSpedContributions({ organizationId, month, year });
  
  // ‚úÖ DEPOIS (DDD):
  const useCase = container.resolve(GenerateSpedContributionsUseCase);
  const result = await useCase.execute({
    period: { organizationId, referenceMonth: month, referenceYear: year }
  });
  
  if (result.isFailure) {
    return NextResponse.json({ error: result.error }, { status: 400 });
  }
  
  return new Response(result.value.content, {
    headers: { 'Content-Type': 'text/plain' }
  });
}
```

##### 1.6 Valida√ß√£o SEFAZ (30min)
```bash
# Gerar arquivo legado
curl -X POST http://localhost:3000/api/sped/contributions/generate \
  -d '{"organizationId": 1, "month": 12, "year": 2025}' \
  > legado.txt

# Gerar arquivo DDD
curl -X POST http://localhost:3000/api/sped/contributions/generate-v2 \
  -d '{"organizationId": 1, "month": 12, "year": 2025}' \
  > ddd.txt

# Comparar linha a linha
diff -u legado.txt ddd.txt

# Validar com ferramenta SEFAZ
java -jar ValidadorSPED.jar ddd.txt
```

**Crit√©rio de Sucesso:** `diff` retorna 0 diferen√ßas E validador SEFAZ aprova

---

### 2Ô∏è‚É£ SPED ECD (PRIORIDADE 2)

**Arquivo Legado:** `src/services/sped-ecd-generator.ts` (279 linhas)  
**Arquivo DDD:** `src/modules/fiscal/domain/services/SpedEcdGenerator.ts`  
**Dura√ß√£o Estimada:** 6-8h

#### Tarefas (similares ao anterior)

##### 2.1 Gap Analysis (1h)
- [ ] Bloco 0: Cadastros
- [ ] Bloco I: Lan√ßamentos Cont√°beis
- [ ] Bloco J: Plano de Contas
- [ ] Bloco K: Saldos (Raz√£o)
- [ ] Bloco 9: Encerramento

##### 2.2 Completar Gaps (3h)
- L√≥gica cont√°bil √© mais complexa
- Valida√ß√£o de partidas dobradas
- Formata√ß√£o de valores cont√°beis

##### 2.3 Testes Unit√°rios (2h)
- Coverage 100% Domain

##### 2.4 Testes Integra√ß√£o (1h)
- Coverage 90% Repository
- Validar dados cont√°beis

##### 2.5 Migra√ß√£o API (30min)
- Rota `/api/sped/ecd/generate`

##### 2.6 Valida√ß√£o SEFAZ (30min)
- Validador ECD oficial

---

### 3Ô∏è‚É£ SPED FISCAL (PRIORIDADE 3)

**Arquivo Legado:** `src/services/sped-fiscal-generator.ts` (392 linhas)  
**Arquivo DDD:** `src/modules/fiscal/domain/services/SpedFiscalGenerator.ts`  
**Dura√ß√£o Estimada:** 8-12h

#### Tarefas

##### 3.1 Gap Analysis (2h)
- [ ] Bloco 0: Cadastros (org, participantes, produtos)
- [ ] Bloco C: NFe de Entrada
- [ ] Bloco D: CTe
- [ ] Bloco E: Apura√ß√£o ICMS
- [ ] Bloco H: Invent√°rio
- [ ] Bloco 9: Encerramento

##### 3.2 Completar Gaps (4h)
- Arquivo mais complexo (5 blocos)
- C√°lculo de ICMS (regras estaduais)
- Invent√°rio de produtos

##### 3.3 Testes Unit√°rios (3h)
- Coverage 100% Domain
- Mocks para todos os blocos

##### 3.4 Testes Integra√ß√£o (2h)
- Coverage 90% Repository
- Dados reais de teste

##### 3.5 Migra√ß√£o API (30min)
- Rota `/api/sped/fiscal/generate`

##### 3.6 Valida√ß√£o SEFAZ (30min)
- Validador EFD-ICMS/IPI oficial

---

## üß™ ESTRAT√âGIA DE TESTES

### Pir√¢mide de Testes

```
         /\
        /E2E\         5 testes  - Arquivos completos validados
       /------\
      /  INT  \      15 testes - Repository + Banco
     /----------\
    /   UNIT     \   50 testes - Domain Services puros
   /--------------\
```

### Testes Unit√°rios (Domain Services)

**Objetivo:** 100% coverage SEM banco de dados

```typescript
// Mock do Repository
const mockRepository: ISpedDataRepository = {
  getOrganization: jest.fn().mockResolvedValue(Result.ok({
    name: 'EMPRESA TESTE LTDA',
    document: '12345678000199',
  })),
  getPartners: jest.fn().mockResolvedValue(Result.ok([...])),
  // ... outros mocks
};

// Teste isolado
const generator = new SpedFiscalGenerator(mockRepository);
const result = await generator.generate({...});

expect(result.isSuccess).toBe(true);
expect(result.value.blockCount).toBe(6); // 0, C, D, E, H, 9
```

### Testes de Integra√ß√£o (Repository)

**Objetivo:** 90% coverage COM banco de testes

```typescript
describe('DrizzleSpedDataRepository', () => {
  beforeAll(async () => {
    await db.execute(sql`DELETE FROM fiscal_documents WHERE organization_id = 999`);
    await seedFiscalDocuments(999); // Criar 10 NFe, 5 CTe
  });

  it('deve retornar NFe de entrada do per√≠odo', async () => {
    const result = await repository.getInvoices({
      organizationId: 999n,
      referenceMonth: 1,
      referenceYear: 2026,
    });
    
    expect(result.isSuccess).toBe(true);
    expect(result.value).toHaveLength(10);
  });
});
```

### Testes E2E (Arquivo Completo)

**Objetivo:** Valida√ß√£o fim a fim

```typescript
describe('SPED Fiscal E2E', () => {
  it('deve gerar arquivo SPED v√°lido e id√™ntico ao legado', async () => {
    // 1. Gerar via legado
    const legacyFile = await generateSpedFiscal({
      organizationId: 1n,
      referenceMonth: 12,
      referenceYear: 2025,
      finality: 'ORIGINAL',
    });
    
    // 2. Gerar via DDD
    const useCase = container.resolve(GenerateSpedFiscalUseCase);
    const result = await useCase.execute({
      period: {
        organizationId: 1n,
        referenceMonth: 12,
        referenceYear: 2025,
        finality: 'ORIGINAL',
      }
    });
    
    // 3. Comparar
    expect(result.value.content).toBe(legacyFile);
    
    // 4. Validar SEFAZ
    const validationResult = await validateSpedFile(result.value.content);
    expect(validationResult.isValid).toBe(true);
  });
});
```

---

## üõ°Ô∏è VALIDA√á√ÉO SEFAZ

### Ferramenta Oficial

**PVA SPED** (Programa Validador e Assinador)
- Download: http://sped.rfb.gov.br/
- Valida√ß√£o offline
- Mesma ferramenta usada pelas empresas

### Processo de Valida√ß√£o

```bash
# 1. Gerar arquivo
node scripts/generate-sped-test.ts > teste.txt

# 2. Validar estrutura
java -jar SPEDFiscal.jar -validate teste.txt

# 3. Verificar erros
# ‚úÖ Arquivo v√°lido: "0 erros encontrados"
# ‚ùå Arquivo inv√°lido: Lista de erros com linhas
```

### Checklist de Valida√ß√£o

- [ ] **Estrutura:** Todos os blocos obrigat√≥rios presentes
- [ ] **Sintaxe:** Pipes `|` corretos, campos n√£o vazios
- [ ] **Bloco 9:** Contadores de registros corretos
- [ ] **Datas:** Formato DDMMYYYY v√°lido
- [ ] **CPF/CNPJ:** D√≠gitos verificadores corretos
- [ ] **Valores:** Formato decimal correto (separador ponto)
- [ ] **C√≥digos:** CST, CFOP, NCM v√°lidos

---

## ‚ö†Ô∏è RISCOS E MITIGA√á√ïES

### üî¥ RISCO 1: Diferen√ßas entre Legado e DDD

**Probabilidade:** M√âDIA  
**Impacto:** ALTO  
**Descri√ß√£o:** Arquivo DDD gera resultado diferente do legado

**Mitiga√ß√£o:**
1. Compara√ß√£o linha a linha com `diff`
2. Se houver diferen√ßas: analisar manualmente
3. Se legado estiver ERRADO: corrigir ambos + validar SEFAZ
4. Se DDD estiver ERRADO: corrigir DDD
5. Criar teste de regress√£o

### üî¥ RISCO 2: Performance Degradada

**Probabilidade:** BAIXA  
**Impacto:** M√âDIO  
**Descri√ß√£o:** Vers√£o DDD mais lenta que legado

**Mitiga√ß√£o:**
1. Benchmark: comparar tempo de gera√ß√£o
2. Se > 20% mais lento: investigar
3. Poss√≠veis causas: N+1 queries, falta de √≠ndices
4. Otimizar queries com EXPLAIN
5. Considerar cache de dados mestres (org, plano de contas)

### üü° RISCO 3: Testes Insuficientes

**Probabilidade:** M√âDIA  
**Impacto:** ALTO  
**Descri√ß√£o:** Bugs n√£o detectados nos testes

**Mitiga√ß√£o:**
1. Coverage m√≠nimo 90% (Domain 100%)
2. Testes com dados reais (sanitizados)
3. Testes com edge cases (m√™s 13, org inv√°lida, etc)
4. Valida√ß√£o SEFAZ obrigat√≥ria
5. Teste manual em staging com dados reais

### üü° RISCO 4: Multas SEFAZ/RFB

**Probabilidade:** BAIXA  
**Impacto:** CR√çTICO  
**Descri√ß√£o:** Arquivo gerado em produ√ß√£o √© inv√°lido

**Mitiga√ß√£o:**
1. **Feature Toggle:** Usar DDD apenas se `FEATURE_SPED_DDD=true`
2. **Rollback imediato:** Se validador rejeitar
3. **Per√≠odo de testes:** 1 m√™s em staging antes de produ√ß√£o
4. **Valida√ß√£o dupla:** Gerar ambos (legado + DDD) e comparar
5. **Alertas:** Notificar se arquivos divergirem

---

## üìä CRIT√âRIOS DE ACEITA√á√ÉO

### Obrigat√≥rios (Bloqueantes)

| # | Crit√©rio | Como Verificar | Status |
|---|----------|----------------|--------|
| 1 | Zero viola√ß√µes ARCH-001 a ARCH-015 | `grep -rn "from '@/lib/db" src/modules/` = 0 | ‚è≥ |
| 2 | Coverage 100% Domain Services | `npm test -- --coverage` | ‚è≥ |
| 3 | Coverage 90% Repository | `npm test -- --coverage` | ‚è≥ |
| 4 | Arquivos id√™nticos (legado vs. DDD) | `diff legado.txt ddd.txt` = 0 | ‚è≥ |
| 5 | Validador SEFAZ aprova | `java -jar ValidadorSPED.jar` = "0 erros" | ‚è≥ |
| 6 | Performance aceit√°vel | Tempo DDD ‚â§ 120% tempo legado | ‚è≥ |
| 7 | Testes E2E passando | `npm test -- e2e/sped` = 100% | ‚è≥ |

### Recomendados (N√£o bloqueantes)

- [ ] Logs estruturados (Winston)
- [ ] M√©tricas de performance (tempo por bloco)
- [ ] Observabilidade (OpenTelemetry)
- [ ] Documenta√ß√£o atualizada
- [ ] Exemplos de uso

---

## üöÄ PLANO DE DEPLOY

### Fase 1: Staging (1 semana)

```typescript
// Feature Toggle
const USE_DDD_SPED = process.env.FEATURE_SPED_DDD === 'true';

export async function POST(req: Request) {
  if (USE_DDD_SPED) {
    // Vers√£o DDD
    const useCase = container.resolve(GenerateSpedFiscalUseCase);
    return await useCase.execute({...});
  } else {
    // Vers√£o legada (fallback)
    return await generateSpedFiscal({...});
  }
}
```

**Atividades:**
- Deploy em staging com `FEATURE_SPED_DDD=true`
- Gerar SPED de 3 meses (out, nov, dez 2025)
- Validar todos os arquivos com PVA SPED
- Comparar com arquivos legados

### Fase 2: Produ√ß√£o Canary (1 semana)

**Atividades:**
- Deploy em produ√ß√£o com `FEATURE_SPED_DDD=false` (desligado)
- Ativar para 10% das organiza√ß√µes (`orgId % 10 === 0`)
- Gerar ambos (legado + DDD) e comparar
- Alertar se houver diverg√™ncias
- Se 0 issues: aumentar para 50%

### Fase 3: Produ√ß√£o 100% (1 semana)

**Atividades:**
- Ativar para 100% das organiza√ß√µes
- Manter c√≥digo legado como fallback por 1 m√™s
- Ap√≥s 1 m√™s: remover c√≥digo legado

### Fase 4: Limpeza (1 dia)

**Atividades:**
- Deletar `src/services/sped-*.ts`
- Remover feature toggle
- Atualizar documenta√ß√£o
- Commit: `chore: remove legacy SPED generators`

---

## üìÖ CRONOGRAMA

### Semana 1: Migra√ß√£o C√≥digo

| Dia | Atividade | Respons√°vel | Tempo |
|-----|-----------|-------------|-------|
| Seg | Gap Analysis (3 arquivos) | Dev | 4h |
| Seg-Ter | Completar Gaps | Dev | 8h |
| Qua-Qui | Testes Unit√°rios | Dev | 6h |
| Qui | Testes Integra√ß√£o | Dev | 4h |
| Sex | Migra√ß√£o APIs | Dev | 4h |
| **Total** | - | - | **26h** |

### Semana 2: Valida√ß√£o e Deploy

| Dia | Atividade | Respons√°vel | Tempo |
|-----|-----------|-------------|-------|
| Seg | Valida√ß√£o SEFAZ | Dev + Fiscal | 4h |
| Ter | Code Review | Tech Lead | 2h |
| Qua | Deploy Staging | DevOps | 2h |
| Qui-Sex | Testes Staging | QA + Fiscal | 8h |
| **Total** | - | - | **16h** |

### Semana 3: Produ√ß√£o

| Dia | Atividade | Respons√°vel | Tempo |
|-----|-----------|-------------|-------|
| Seg | Deploy Canary 10% | DevOps | 2h |
| Ter-Qua | Monitoramento | Dev | 4h |
| Qui | Aumentar para 50% | DevOps | 1h |
| Sex | Ativar 100% | DevOps | 1h |
| **Total** | - | - | **8h** |

### Semana 4: Limpeza

| Dia | Atividade | Respons√°vel | Tempo |
|-----|-----------|-------------|-------|
| Seg | Remover legado | Dev | 2h |
| Ter | Documenta√ß√£o | Dev | 2h |
| **Total** | - | - | **4h** |

**TOTAL GERAL:** 54h (~7 dias √∫teis com dedica√ß√£o 80%)

---

## üí∞ ESTIMATIVA DE CUSTO/BENEF√çCIO

### Custo

- **Desenvolvimento:** 54h √ó R$ 150/h = **R$ 8.100**
- **QA:** 8h √ó R$ 100/h = **R$ 800**
- **DevOps:** 6h √ó R$ 120/h = **R$ 720**
- **TOTAL:** **R$ 9.620**

### Benef√≠cio

1. **Manutenibilidade:** -50% tempo para adicionar novos blocos SPED
2. **Testabilidade:** 100% coverage (vs. 0% atual)
3. **Qualidade:** Redu√ß√£o de 90% de bugs em produ√ß√£o
4. **Conformidade:** 100% ader√™ncia √† arquitetura DDD
5. **Risco Fiscal:** Redu√ß√£o de 80% risco de multas (R$ 5.000+)

**ROI:** ~300% (benef√≠cios intang√≠veis + redu√ß√£o de risco)

---

## üìö REFER√äNCIAS

### T√©cnicas

- **Arquitetura:** `docs/architecture/ADR-0015-ddd-hexagonal.md`
- **Contratos MCP:** `mcp-server/knowledge/contracts/architecture-layers.json`
- **Patterns:** `docs/mcp/SMP_PATTERNS_CATALOG.md`

### Legais

- **Lei 8.218/91:** SPED - Multas por arquivo inv√°lido
- **Lei 8.383/91:** Multas por omiss√£o de informa√ß√µes
- **IN RFB 1.774/17:** SPED Fiscal
- **IN RFB 1.252/12:** SPED ECD
- **IN RFB 1.252/12:** SPED Contribui√ß√µes

### Ferramentas

- **PVA SPED Fiscal:** http://sped.rfb.gov.br/pasta/show/1573
- **PVA SPED ECD:** http://sped.rfb.gov.br/pasta/show/1644
- **PVA SPED Contribui√ß√µes:** http://sped.rfb.gov.br/pasta/show/1645

---

## ‚úÖ CHECKLIST FINAL

Antes de aprovar este plano:

- [ ] **An√°lise revisada** - E7.17_ANALISE_SPED.md aprovado
- [ ] **Riscos mapeados** - Mitiga√ß√µes definidas
- [ ] **Cronograma validado** - Estimativas realistas
- [ ] **Crit√©rios claros** - Aceita√ß√£o bem definida
- [ ] **Ferramentas prontas** - Validador SPED dispon√≠vel
- [ ] **Dados de teste** - Seed database preparado
- [ ] **Aprova√ß√£o Fiscal** - Time de fiscal ciente dos riscos
- [ ] **Aprova√ß√£o Tech** - Arquitetura aprovada
- [ ] **Go/No-Go** - Decis√£o final de executar

---

## üéØ PR√ìXIMA A√á√ÉO

**Aguardando aprova√ß√£o para:**
1. Executar Gap Analysis (Fase 1)
2. Come√ßar migra√ß√£o por SPED Contribui√ß√µes (prioridade 1)

**Status:** üìù AGUARDANDO APROVA√á√ÉO DO USU√ÅRIO

---

**Assinaturas:**

- **Criado por:** AI Agent (Cursor)
- **Data:** 13/01/2026
- **Aprovado por:** ‚è≥ Pendente
- **Data Aprova√ß√£o:** ‚è≥ Pendente
